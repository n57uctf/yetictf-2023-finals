# Vulnogramm

**Разработчик Аvsjanka**
  
**Контакты:@avsjanka**
  

**Суть сервиса:**

Основным вопросом для извлечения флагов является то как снять вотермарку. Проанализировав код можно понять, что для созднания картинок с вотермарками используется ImageMagick.

Возникает вопрос как снять вотермарку. На самом деле не так уж и сложно. Наложим вотермарку на разные картинки и попытаемся понять как образуется новый цвет, а цвет образуется по следующий формуле: ```new_color = (origin_color + watermark_color) * alfa```

    > new_color - цвет картинки с вотермакой

    > origin_color - цвет оригинальной картики 

    > watermark_color - цвет вотермарки 

    > alfa - альфа 0 - 1.0 или (1/alfa), где alfa от 0 - 256 byte

При чём округление всегда будет происходить вверх.

Таким образом есть 2 возможных варианта цвета оригинального флага, но так как в коде сервиса пиксели с флагом всегда имеют чётное значение цвета чётными, то более чем очевидно, что нужно либо вычесть ещё 1 если у вотермарки этот цвет нечётный. На основе этих данных напишем срипт который извлекает цвета. 

Известно, что флаг имеет длину 32 символа. Следовательно нам понадобятся 11 членов последовательности Фибоначчи.

В случае с LSB алгоритм примерно тот же просто будет необходимо удалить лишний 0 в конце.

Для надписи, убирание вотермарки не неободимо можно извлечть текст за счёт фильтров и библиотек, которые вычитывают текст(примерную суть работы можно увидеть в чекере)

***Способ защиты:***

Поменять вотермарку, однако её тоже можно извлечть тем же способом, что и до этого, либо её рандомная генерация. Только выкачивать и анализировать мы будем чужие вотермарки. 

Также можно накладывать непрозрачную картинку, однако это нарушает целостность изображения, поэтому предплогагалось, что такое решение будет не спортивным.
